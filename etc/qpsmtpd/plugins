#
#  This is /etc/qpsmtpd/plugins
#
#  It specifies the plugins which should be loaded by qpsmtpd.
#
#  The plugins listed here are all located beneath the directory:
#
#      /usr/share/qpsmtpd/plugins.local/
#
#
# Steve
# --
#




##
#
# If there is any local configuration, for example SMTP-authentication
# or relay control, then this can be included first.
#
###
#
$include plugins.local



##
#
# If the local load is too high deny new connections.
#
# This plugin works globally, and is not affected by per-domain configuration.
#
#
###

global/system_load load 3






##
#
#  Test that the incoming mail was addressed to a valid recipient.
#
#  This plugin must be called first, or second.  Without this plugin the
# expected notes and values will not be available for futher use.
#
#
###

global/test_recipient





##
#
# Disconnect clients that send too many unrecognised commands.
#
# Clients disconnected in this fashion will *not* have their mail archived
# to the quarantine area.
#
##

global/unrecognized_commands




##
#
# Greylisting for this domain.
#
# This plugin is enabled if the following file is present:
#
#   /srv/example.com/checks/greylisting
#
# This allows the plugin to be enabled or disabled on a per-domain basis.
#
# Note: Greylisting is less effective than it used to be and I don't recommend
# its use.  Still if you like it you can use it.
#
#
###

checks/greylisting





##
#
# Test that the client identified itself properly.
#
# This plugin is enabled if either of the following files are present:
#
#   /srv/example.com/checks/helo
#   /srv/example.com/checks/all
#
# This allows the plugin to be enabled or disabled on a per-domain basis.
#
###

checks/helo





##
#
# Test the connecting client has reverse DNS setup.
#
# This plugin is enabled if either of the following files are present:
#
#   /srv/example.com/checks/rdns
#   /srv/example.com/checks/all
#
# This allows the plugin to be enabled or disabled on a per-domain basis.
#
#
###

checks/rdns





##
#
# Test the mail has a Date: header.
#
# This plugin is enabled if either of the following files are present:
#
#   /srv/example.com/checks/date
#   /srv/example.com/checks/all
#
# This allows the plugin to be enabled or disabled on a per-domain basis.
#
#
###

checks/date



##
#
# Check the mail body has sensible values in the To: abd From: fields.
#
# This plugin is enabled if either of the following files are present:
#
#   /srv/example.com/checks/address
#   /srv/example.com/checks/all
#
# This allows the plugin to be enabled or disabled on a per-domain basis.
#
##

checks/address


#
# Block known-bad mailers
#
# This plugin is enabled if either of the following files are present:
#
#   /srv/example.com/checks/mailers
#   /srv/example.com/checks/all
#
# This allows the plugin to be enabled or disabled on a per-domain basis.
#
#
###

checks/mailers




##
#
# Look for mail which should be DKIM signed, but which isn't.
#
# This plugin is enabled if either of the following files are present:
#
#   /srv/example.com/checks/dkim
#   /srv/example.com/checks/all
#
# This allows the plugin to be enabled or disabled on a per-domain basis.
#
#
##

checks/dkim




##
#
# Look for virus-infected mails.
#
# This plugin is enabled if either of the following files are present:
#
#   /srv/example.com/checks/clamav
#   /srv/example.com/checks/all
#
# This allows the plugin to be enabled or disabled on a per-domain basis.
#
# Note this plugin will silently disable itself is the clamdscan binary
# is not installed.
#
##

checks/clamav







##
#
#  Whitelist + Blacklist handling
#
###

global/black_list
global/white_list





##
#
#  Archive or deliver the mail.
#
##
queue/alter
queue/archive /spam/
queue/deliver
